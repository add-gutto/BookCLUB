<script>
document.getElementById('search-form').addEventListener('submit', function(e) {
    e.preventDefault();

    const query = this.query.value;

    fetch("{% url 'user_search' %}", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "X-CSRFToken": "{{ csrf_token }}"
        },
        body: JSON.stringify({ query })
    })
    .then(response => response.text())
    .then(html => {
        const cleanHtml = DOMPurify.sanitize(html, {
            ADD_TAGS: ['table', 'tbody', 'tr', 'td'],
            ADD_ATTR: ['class', 'style']
        });
        document.getElementById('users-container').innerHTML = cleanHtml;
    })
    .catch(error => console.error(error));
});
</script>