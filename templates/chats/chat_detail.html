{% extends "_base.html" %}
{% load static %}
{% block content %}
<div class="chat-main" id="chatMain">
    <div class="chat-header">
        <div class="back-chat-auth">
            <button class="mobile-back-btn" id="mobileBackBtn">
                <i class="fas fa-arrow-left"></i>
            </button>
            <div class="chat-user-info" id="chatUserInfo">
                <img src="{% if chat.imagem %}{{ chat.imagem.url }}{%else %}{% static 'template/img/placeholder.jpg' %}{% endif %}"
                    class="chat-avatar currentChatAvatar rounded-circle" width="40" height="40"
                    style="object-fit: cover;">
                <div class="chat-user-details">
                    <h3 class="currentChatName">{{chat.nome}}</h3>
                    <div class="chat-user-status">Active now</div>
                </div>
            </div>
        </div>

        <div class="chat-actions">
            <div class="ms-2 dropdown">
                <button class="btn d-flex align-items-center justify-content-center" type="button" id="dropdownFiltro"
                    data-bs-toggle="dropdown" aria-expanded="false"
                    style="height: 60px; width: 60px; background: none; border: none;">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="1"></circle>
                        <circle cx="19" cy="12" r="1"></circle>
                        <circle cx="5" cy="12" r="1"></circle>
                    </svg>
                </button>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownFiltro">
                    <li><a class="dropdown-item" href="#" data-filtro="todos">Sobre Livro</a></li>
                    <li><a class="dropdown-item" href="#" data-filtro="seguindo">Avaliar Livro</a></li>
                    <li><a class="dropdown-item" href="#" data-filtro="seguidores">Denunciar</a></li>
                </ul>
            </div>
        </div>
    </div>

    <div class="chat-messages" id="chatMessages">
        <div class="d-flex align-items-end gap-2  message received" data-message-id="1">
            <img class="img-profile rounded-circle"
                src="{% if request.user.profile.profile_picture %}{{ request.user.profile.profile_picture.url }}{% else %}{% static 'template/img/placeholder.jpg' %}{% endif %}"
                width="40" height="40" style="object-fit: cover;">
            <div class="message-wrapper">
                <div class="message-content">
                    <a href="{% url 'user-profile' request.user.id %}">
                        <span class="d-none d-lg-inline text-gray-600 me-2">{{ request.user.username }}</span>
                    </a>
                    <div class="message-text mt-2">Hey! How are you doing today?</div>
                </div>
                <div class="message-timestamp">10:30 AM</div>
                <div class="message-actions">
                    <button class="message-action-btn more-options" title="More options">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                    <div class="message-dropdown">
                        <div class="dropdown-item edit">
                            <i class="fas fa-pencil-alt"></i> Edit
                        </div>
                        <div class="dropdown-item delete">
                            <i class="fas fa-trash"></i> Delete
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="message sent" data-message-id="2">
            <div class="message-wrapper">
                <div class="message-content">
                    <div class="message-text">I'm doing great! Just finished my morning workout. How about you?
                    </div>
                </div>
                <div class="message-timestamp">
                    10:32 AM
                    <div class="message-status">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" class="single-tick" width="16px"
                            height="16px">
                            <path
                                d="M 26.980469 5.9902344 A 1.0001 1.0001 0 0 0 26.292969 6.2929688 L 11 21.585938 L 4.7070312 15.292969 A 1.0001 1.0001 0 1 0 3.2929688 16.707031 L 10.292969 23.707031 A 1.0001 1.0001 0 0 0 11.707031 23.707031 L 27.707031 7.7070312 A 1.0001 1.0001 0 0 0 26.980469 5.9902344 z">
                            </path>
                        </svg>
                    </div>
                </div>
                <div class="message-actions">
                    <button class="message-action-btn more-options" title="More options">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                    <div class="message-dropdown">
                        <div class="dropdown-item edit">
                            <i class="fas fa-pencil-alt"></i> Edit
                        </div>
                        <div class="dropdown-item delete">
                            <i class="fas fa-trash"></i> Delete
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="d-flex align-items-end gap-2  message received" data-message-id="3">
            <img class="img-profile rounded-circle"
                src="{% if request.user.profile.profile_picture %}{{ request.user.profile.profile_picture.url }}{% else %}{% static 'template/img/placeholder.jpg' %}{% endif %}"
                width="40" height="40" style="object-fit: cover;">
            <div class="message-wrapper">
                <div class="message-content">
                    <a href="{% url 'user-profile' request.user.id %}">
                        <span class="d-none d-lg-inline text-gray-600 me-2">{{ request.user.username }}</span>
                    </a>
                    <div class="image-message mt-2">
                        <img src="assets/images/454.jpg" alt="Shared image" loading="lazy" data-lightbox-registered="1">
                    </div>
                </div>
                <div class="message-timestamp">10:33 AM</div>
                <div class="message-actions">
                    <button class="message-action-btn more-options" title="More options">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                    <div class="message-dropdown">
                        <div class="dropdown-item edit">
                            <i class="fas fa-pencil-alt"></i> Edit
                        </div>
                        <div class="dropdown-item delete">
                            <i class="fas fa-trash"></i> Delete
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="message sent" data-message-id="4">
            <div class="message-wrapper">
                <div class="message-content">
                    <div class="file-message">
                        <div class="file-icon pdf">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14,2 14,8 20,8"></polyline>
                            </svg>
                        </div>
                        <div class="file-info">
                            <div class="file-name">Proposal.pdf</div>
                            <div class="file-size">2.4 MB</div>
                        </div>
                        <button class="file-download">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="7,10 12,15 17,10"></polyline>
                                <line x1="12" y1="15" x2="12" y2="3"></line>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="message-timestamp">
                    10:35 AM
                    <div class="message-status">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="15" class="double-tick" x="2063"
                            y="2076">
                            <path
                                d="M15.01 3.316l-.478-.372a.365.365 0 0 0-.51.063L8.666 9.88a.32.32 0 0 1-.484.032l-.358-.325a.32.32 0 0 0-.484.032l-.378.48a.418.418 0 0 0 .036.54l1.32 1.267a.32.32 0 0 0 .484-.034l6.272-8.048a.366.366 0 0 0-.064-.512zm-4.1 0l-.478-.372a.365.365 0 0 0-.51.063L4.566 9.88a.32.32 0 0 1-.484.032L1.892 7.77a.366.366 0 0 0-.516.005l-.423.433a.364.364 0 0 0 .006.514l3.255 3.185a.32.32 0 0 0 .484-.033l6.272-8.048a.365.365 0 0 0-.063-.51z"
                                fill="#000"></path>
                        </svg>
                    </div>
                </div>

                <div class="message-actions">
                    <button class="message-action-btn more-options" title="More options">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                    <div class="message-dropdown">
                        <div class="dropdown-item edit">
                            <i class="fas fa-pencil-alt"></i> Edit
                        </div>
                        <div class="dropdown-item delete">
                            <i class="fas fa-trash"></i> Delete
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="d-flex align-items-end gap-2  message received group" data-message-id="3">
            <img class="img-profile rounded-circle"
                src="{% if request.user.profile.profile_picture %}{{ request.user.profile.profile_picture.url }}{% else %}{% static 'template/img/placeholder.jpg' %}{% endif %}"
                width="40" height="40" style="object-fit: cover;">
            <div class="message-wrapper">
                <div class="message-content">
                    <a href="{% url 'user-profile' request.user.id %}">
                        <span class="d-none d-lg-inline text-gray-600 me-2">{{ request.user.username }}</span>
                    </a>
                    <div class="files-gallery multiple mt-2">
                        <div class="gallery-item">
                            <img src="assets/images/1.jpg" alt="Design mockup 1" data-lightbox-registered="1">
                        </div>
                        <div class="gallery-item">
                            <img src="assets/images/2.jpg" alt="Design mockup 1" data-lightbox-registered="1">
                        </div>
                        <div class="gallery-item">
                            <img src="assets/images/3.jpg" alt="Design mockup 1" data-lightbox-registered="1">
                        </div>
                        <div class="gallery-item">
                            <div class="gallery-overlay gallery-more">+5 more</div>
                            <img src="assets/images/4.jpg" alt="Design mockup 1" data-lightbox-registered="1">
                        </div>
                    </div>
                </div>
                <div class="message-timestamp">10:33 AM</div>
                <div class="message-actions">
                    <button class="message-action-btn more-options" title="More options">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                    <div class="message-dropdown">
                        <div class="dropdown-item edit">
                            <i class="fas fa-pencil-alt"></i> Edit
                        </div>
                        <div class="dropdown-item delete">
                            <i class="fas fa-trash"></i> Delete
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="message sent" data-message-id="4">
            <div class="message-wrapper">
                <div class="message-content">
                    How are you?
                </div>
                <div class="message-timestamp">
                    10:35 AM
                    <div class="message-status double-tick">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="15" id="msg-dblcheck-ack" x="2063"
                            y="2076">
                            <path
                                d="M15.01 3.316l-.478-.372a.365.365 0 0 0-.51.063L8.666 9.88a.32.32 0 0 1-.484.032l-.358-.325a.32.32 0 0 0-.484.032l-.378.48a.418.418 0 0 0 .036.54l1.32 1.267a.32.32 0 0 0 .484-.034l6.272-8.048a.366.366 0 0 0-.064-.512zm-4.1 0l-.478-.372a.365.365 0 0 0-.51.063L4.566 9.88a.32.32 0 0 1-.484.032L1.892 7.77a.366.366 0 0 0-.516.005l-.423.433a.364.364 0 0 0 .006.514l3.255 3.185a.32.32 0 0 0 .484-.033l6.272-8.048a.365.365 0 0 0-.063-.51z"
                                fill="#4fc3f7"></path>
                        </svg>

                    </div>
                </div>

                <div class="message-actions">
                    <button class="message-action-btn more-options" title="More options">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                    <div class="message-dropdown">
                        <div class="dropdown-item edit">
                            <i class="fas fa-pencil-alt"></i> Edit
                        </div>
                        <div class="dropdown-item delete">
                            <i class="fas fa-trash"></i> Delete
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="message received">
            <div class="typing-indicator">
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- File Preview Area -->
    <div class="file-preview" id="filePreview"></div>

    <div class="chat-input">
        <div class="input-container">
            <div class="input-actions">
                <input type="file" class="file-input" id="fileInput" multiple="" accept="*/*">
                <button class="input-action-btn" id="attachFileBtn" title="Attach File">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path
                            d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66L9.64 16.2a2 2 0 0 1-2.83-2.83l8.49-8.49">
                        </path>
                    </svg>
                </button>
                <input type="file" class="file-input" id="imageInput" accept="image/*">
                <button class="input-action-btn" id="sendImageBtn" title="Send Image">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <circle cx="8.5" cy="8.5" r="1.5"></circle>
                        <polyline points="21,15 16,10 5,21"></polyline>
                    </svg>
                </button>
            </div>
            <textarea class="message-input" placeholder="Type a message..." rows="1" id="messageInput"></textarea>
            <button class="input-action-btn" id="sendAudioBtn">
                <svg fill="currentColor" width="16" height="16" version="1.1" xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 512 512" xmlns:xlink="http://www.w3.org/1999/xlink"
                    enable-background="new 0 0 512 512">
                    <g>
                        <g>
                            <path
                                d="m439.5,236c0-11.3-9.1-20.4-20.4-20.4s-20.4,9.1-20.4,20.4c0,70-64,126.9-142.7,126.9-78.7,0-142.7-56.9-142.7-126.9 0-11.3-9.1-20.4-20.4-20.4s-20.4,9.1-20.4,20.4c0,86.2 71.5,157.4 163.1,166.7v57.5h-23.6c-11.3,0-20.4,9.1-20.4,20.4 0,11.3 9.1,20.4 20.4,20.4h88c11.3,0 20.4-9.1 20.4-20.4 0-11.3-9.1-20.4-20.4-20.4h-23.6v-57.5c91.6-9.3 163.1-80.5 163.1-166.7z">
                            </path>
                            <path
                                d="m256,323.5c51,0 92.3-41.3 92.3-92.3v-127.9c0-51-41.3-92.3-92.3-92.3s-92.3,41.3-92.3,92.3v127.9c0,51 41.3,92.3 92.3,92.3zm-52.3-220.2c0-28.8 23.5-52.3 52.3-52.3s52.3,23.5 52.3,52.3v127.9c0,28.8-23.5,52.3-52.3,52.3s-52.3-23.5-52.3-52.3v-127.9z">
                            </path>
                        </g>
                    </g>
                </svg>
            </button>
            <button class="send-button" id="sendButton">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="22" y1="2" x2="11" y2="13"></line>
                    <polygon points="22,2 15,22 11,13 2,9"></polygon>
                </svg>
            </button>
        </div>
    </div>
</div>
{% endblock %}